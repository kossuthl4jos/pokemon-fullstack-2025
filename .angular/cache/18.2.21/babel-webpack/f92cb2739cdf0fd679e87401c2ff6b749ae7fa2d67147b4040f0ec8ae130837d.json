{"ast":null,"code":"import { assertInInjectionContext, inject, Injector, DestroyRef, NgZone, computed, signal } from \"@angular/core\";\nimport { QueryClient, notifyManager, replaceEqualDeep } from \"@tanstack/query-core\";\nfunction getResult(mutationCache, options) {\n  return mutationCache.findAll(options.filters).map(mutation => options.select ? options.select(mutation) : mutation.state);\n}\nfunction injectMutationState(injectMutationStateFn = () => ({}), options) {\n  !(options == null ? void 0 : options.injector) && assertInInjectionContext(injectMutationState);\n  const injector = (options == null ? void 0 : options.injector) ?? inject(Injector);\n  const destroyRef = injector.get(DestroyRef);\n  const ngZone = injector.get(NgZone);\n  const queryClient = injector.get(QueryClient);\n  const mutationCache = queryClient.getMutationCache();\n  const resultFromOptionsSignal = computed(() => {\n    return [getResult(mutationCache, injectMutationStateFn()), performance.now()];\n  });\n  const resultFromSubscriberSignal = signal(null);\n  const effectiveResultSignal = computed(() => {\n    const optionsResult = resultFromOptionsSignal();\n    const subscriberResult = resultFromSubscriberSignal();\n    return subscriberResult && subscriberResult[1] > optionsResult[1] ? subscriberResult[0] : optionsResult[0];\n  });\n  const unsubscribe = ngZone.runOutsideAngular(() => mutationCache.subscribe(notifyManager.batchCalls(() => {\n    const [lastResult] = effectiveResultSignal();\n    const nextResult = replaceEqualDeep(lastResult, getResult(mutationCache, injectMutationStateFn()));\n    if (lastResult !== nextResult) {\n      ngZone.run(() => {\n        resultFromSubscriberSignal.set([nextResult, performance.now()]);\n      });\n    }\n  })));\n  destroyRef.onDestroy(unsubscribe);\n  return effectiveResultSignal;\n}\nexport { injectMutationState };","map":{"version":3,"names":["assertInInjectionContext","inject","Injector","DestroyRef","NgZone","computed","signal","QueryClient","notifyManager","replaceEqualDeep","getResult","mutationCache","options","findAll","filters","map","mutation","select","state","injectMutationState","injectMutationStateFn","injector","destroyRef","get","ngZone","queryClient","getMutationCache","resultFromOptionsSignal","performance","now","resultFromSubscriberSignal","effectiveResultSignal","optionsResult","subscriberResult","unsubscribe","runOutsideAngular","subscribe","batchCalls","lastResult","nextResult","run","set","onDestroy"],"sources":["E:/Projects/pokemon-angular-2025/node_modules/@tanstack/angular-query-experimental/inject-mutation-state.mjs"],"sourcesContent":["import { assertInInjectionContext, inject, Injector, DestroyRef, NgZone, computed, signal } from \"@angular/core\";\nimport { QueryClient, notifyManager, replaceEqualDeep } from \"@tanstack/query-core\";\nfunction getResult(mutationCache, options) {\n  return mutationCache.findAll(options.filters).map(\n    (mutation) => options.select ? options.select(mutation) : mutation.state\n  );\n}\nfunction injectMutationState(injectMutationStateFn = () => ({}), options) {\n  !(options == null ? void 0 : options.injector) && assertInInjectionContext(injectMutationState);\n  const injector = (options == null ? void 0 : options.injector) ?? inject(Injector);\n  const destroyRef = injector.get(DestroyRef);\n  const ngZone = injector.get(NgZone);\n  const queryClient = injector.get(QueryClient);\n  const mutationCache = queryClient.getMutationCache();\n  const resultFromOptionsSignal = computed(() => {\n    return [\n      getResult(mutationCache, injectMutationStateFn()),\n      performance.now()\n    ];\n  });\n  const resultFromSubscriberSignal = signal(\n    null\n  );\n  const effectiveResultSignal = computed(() => {\n    const optionsResult = resultFromOptionsSignal();\n    const subscriberResult = resultFromSubscriberSignal();\n    return subscriberResult && subscriberResult[1] > optionsResult[1] ? subscriberResult[0] : optionsResult[0];\n  });\n  const unsubscribe = ngZone.runOutsideAngular(\n    () => mutationCache.subscribe(\n      notifyManager.batchCalls(() => {\n        const [lastResult] = effectiveResultSignal();\n        const nextResult = replaceEqualDeep(\n          lastResult,\n          getResult(mutationCache, injectMutationStateFn())\n        );\n        if (lastResult !== nextResult) {\n          ngZone.run(() => {\n            resultFromSubscriberSignal.set([nextResult, performance.now()]);\n          });\n        }\n      })\n    )\n  );\n  destroyRef.onDestroy(unsubscribe);\n  return effectiveResultSignal;\n}\nexport {\n  injectMutationState\n};\n"],"mappings":"AAAA,SAASA,wBAAwB,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,eAAe;AAChH,SAASC,WAAW,EAAEC,aAAa,EAAEC,gBAAgB,QAAQ,sBAAsB;AACnF,SAASC,SAASA,CAACC,aAAa,EAAEC,OAAO,EAAE;EACzC,OAAOD,aAAa,CAACE,OAAO,CAACD,OAAO,CAACE,OAAO,CAAC,CAACC,GAAG,CAC9CC,QAAQ,IAAKJ,OAAO,CAACK,MAAM,GAAGL,OAAO,CAACK,MAAM,CAACD,QAAQ,CAAC,GAAGA,QAAQ,CAACE,KACrE,CAAC;AACH;AACA,SAASC,mBAAmBA,CAACC,qBAAqB,GAAGA,CAAA,MAAO,CAAC,CAAC,CAAC,EAAER,OAAO,EAAE;EACxE,EAAEA,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACS,QAAQ,CAAC,IAAIrB,wBAAwB,CAACmB,mBAAmB,CAAC;EAC/F,MAAME,QAAQ,GAAG,CAACT,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACS,QAAQ,KAAKpB,MAAM,CAACC,QAAQ,CAAC;EAClF,MAAMoB,UAAU,GAAGD,QAAQ,CAACE,GAAG,CAACpB,UAAU,CAAC;EAC3C,MAAMqB,MAAM,GAAGH,QAAQ,CAACE,GAAG,CAACnB,MAAM,CAAC;EACnC,MAAMqB,WAAW,GAAGJ,QAAQ,CAACE,GAAG,CAAChB,WAAW,CAAC;EAC7C,MAAMI,aAAa,GAAGc,WAAW,CAACC,gBAAgB,CAAC,CAAC;EACpD,MAAMC,uBAAuB,GAAGtB,QAAQ,CAAC,MAAM;IAC7C,OAAO,CACLK,SAAS,CAACC,aAAa,EAAES,qBAAqB,CAAC,CAAC,CAAC,EACjDQ,WAAW,CAACC,GAAG,CAAC,CAAC,CAClB;EACH,CAAC,CAAC;EACF,MAAMC,0BAA0B,GAAGxB,MAAM,CACvC,IACF,CAAC;EACD,MAAMyB,qBAAqB,GAAG1B,QAAQ,CAAC,MAAM;IAC3C,MAAM2B,aAAa,GAAGL,uBAAuB,CAAC,CAAC;IAC/C,MAAMM,gBAAgB,GAAGH,0BAA0B,CAAC,CAAC;IACrD,OAAOG,gBAAgB,IAAIA,gBAAgB,CAAC,CAAC,CAAC,GAAGD,aAAa,CAAC,CAAC,CAAC,GAAGC,gBAAgB,CAAC,CAAC,CAAC,GAAGD,aAAa,CAAC,CAAC,CAAC;EAC5G,CAAC,CAAC;EACF,MAAME,WAAW,GAAGV,MAAM,CAACW,iBAAiB,CAC1C,MAAMxB,aAAa,CAACyB,SAAS,CAC3B5B,aAAa,CAAC6B,UAAU,CAAC,MAAM;IAC7B,MAAM,CAACC,UAAU,CAAC,GAAGP,qBAAqB,CAAC,CAAC;IAC5C,MAAMQ,UAAU,GAAG9B,gBAAgB,CACjC6B,UAAU,EACV5B,SAAS,CAACC,aAAa,EAAES,qBAAqB,CAAC,CAAC,CAClD,CAAC;IACD,IAAIkB,UAAU,KAAKC,UAAU,EAAE;MAC7Bf,MAAM,CAACgB,GAAG,CAAC,MAAM;QACfV,0BAA0B,CAACW,GAAG,CAAC,CAACF,UAAU,EAAEX,WAAW,CAACC,GAAG,CAAC,CAAC,CAAC,CAAC;MACjE,CAAC,CAAC;IACJ;EACF,CAAC,CACH,CACF,CAAC;EACDP,UAAU,CAACoB,SAAS,CAACR,WAAW,CAAC;EACjC,OAAOH,qBAAqB;AAC9B;AACA,SACEZ,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}