{"ast":null,"code":"import _asyncToGenerator from \"E:/Projects/pokemon-angular-2025/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _asyncIterator from \"E:/Projects/pokemon-angular-2025/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";\n// src/streamedQuery.ts\nimport { addToEnd } from \"./utils.js\";\nfunction streamedQuery({\n  streamFn,\n  refetchMode = \"reset\",\n  reducer = (items, chunk) => addToEnd(items, chunk),\n  initialValue = []\n}) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (context) {\n      const query = context.client.getQueryCache().find({\n        queryKey: context.queryKey,\n        exact: true\n      });\n      const isRefetch = !!query && query.state.data !== void 0;\n      if (isRefetch && refetchMode === \"reset\") {\n        query.setState({\n          status: \"pending\",\n          data: void 0,\n          error: null,\n          fetchStatus: \"fetching\"\n        });\n      }\n      let result = initialValue;\n      const stream = yield streamFn(context);\n      var _iteratorAbruptCompletion = false;\n      var _didIteratorError = false;\n      var _iteratorError;\n      try {\n        for (var _iterator = _asyncIterator(stream), _step; _iteratorAbruptCompletion = !(_step = yield _iterator.next()).done; _iteratorAbruptCompletion = false) {\n          const chunk = _step.value;\n          {\n            if (context.signal.aborted) {\n              break;\n            }\n            if (!isRefetch || refetchMode !== \"replace\") {\n              context.client.setQueryData(context.queryKey, prev => reducer(prev === void 0 ? initialValue : prev, chunk));\n            }\n            result = reducer(result, chunk);\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (_iteratorAbruptCompletion && _iterator.return != null) {\n            yield _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n      if (isRefetch && refetchMode === \"replace\" && !context.signal.aborted) {\n        context.client.setQueryData(context.queryKey, result);\n      }\n      return context.client.getQueryData(context.queryKey);\n    });\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}\nexport { streamedQuery };","map":{"version":3,"names":["addToEnd","streamedQuery","streamFn","refetchMode","reducer","items","chunk","initialValue","_ref","_asyncToGenerator","context","query","client","getQueryCache","find","queryKey","exact","isRefetch","state","data","setState","status","error","fetchStatus","result","stream","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_asyncIterator","_step","next","done","value","signal","aborted","setQueryData","prev","err","return","getQueryData","_x","apply","arguments"],"sources":["E:/Projects/pokemon-angular-2025/node_modules/@tanstack/query-core/build/modern/streamedQuery.js"],"sourcesContent":["// src/streamedQuery.ts\nimport { addToEnd } from \"./utils.js\";\nfunction streamedQuery({\n  streamFn,\n  refetchMode = \"reset\",\n  reducer = (items, chunk) => addToEnd(items, chunk),\n  initialValue = []\n}) {\n  return async (context) => {\n    const query = context.client.getQueryCache().find({ queryKey: context.queryKey, exact: true });\n    const isRefetch = !!query && query.state.data !== void 0;\n    if (isRefetch && refetchMode === \"reset\") {\n      query.setState({\n        status: \"pending\",\n        data: void 0,\n        error: null,\n        fetchStatus: \"fetching\"\n      });\n    }\n    let result = initialValue;\n    const stream = await streamFn(context);\n    for await (const chunk of stream) {\n      if (context.signal.aborted) {\n        break;\n      }\n      if (!isRefetch || refetchMode !== \"replace\") {\n        context.client.setQueryData(\n          context.queryKey,\n          (prev) => reducer(prev === void 0 ? initialValue : prev, chunk)\n        );\n      }\n      result = reducer(result, chunk);\n    }\n    if (isRefetch && refetchMode === \"replace\" && !context.signal.aborted) {\n      context.client.setQueryData(context.queryKey, result);\n    }\n    return context.client.getQueryData(context.queryKey);\n  };\n}\nexport {\n  streamedQuery\n};\n"],"mappings":";;AAAA;AACA,SAASA,QAAQ,QAAQ,YAAY;AACrC,SAASC,aAAaA,CAAC;EACrBC,QAAQ;EACRC,WAAW,GAAG,OAAO;EACrBC,OAAO,GAAGA,CAACC,KAAK,EAAEC,KAAK,KAAKN,QAAQ,CAACK,KAAK,EAAEC,KAAK,CAAC;EAClDC,YAAY,GAAG;AACjB,CAAC,EAAE;EACD;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAO,WAAOC,OAAO,EAAK;MACxB,MAAMC,KAAK,GAAGD,OAAO,CAACE,MAAM,CAACC,aAAa,CAAC,CAAC,CAACC,IAAI,CAAC;QAAEC,QAAQ,EAAEL,OAAO,CAACK,QAAQ;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC;MAC9F,MAAMC,SAAS,GAAG,CAAC,CAACN,KAAK,IAAIA,KAAK,CAACO,KAAK,CAACC,IAAI,KAAK,KAAK,CAAC;MACxD,IAAIF,SAAS,IAAId,WAAW,KAAK,OAAO,EAAE;QACxCQ,KAAK,CAACS,QAAQ,CAAC;UACbC,MAAM,EAAE,SAAS;UACjBF,IAAI,EAAE,KAAK,CAAC;UACZG,KAAK,EAAE,IAAI;UACXC,WAAW,EAAE;QACf,CAAC,CAAC;MACJ;MACA,IAAIC,MAAM,GAAGjB,YAAY;MACzB,MAAMkB,MAAM,SAASvB,QAAQ,CAACQ,OAAO,CAAC;MAAC,IAAAgB,yBAAA;MAAA,IAAAC,iBAAA;MAAA,IAAAC,cAAA;MAAA;QACvC,SAAAC,SAAA,GAAAC,cAAA,CAA0BL,MAAM,GAAAM,KAAA,EAAAL,yBAAA,KAAAK,KAAA,SAAAF,SAAA,CAAAG,IAAA,IAAAC,IAAA,EAAAP,yBAAA,UAAE;UAAA,MAAjBpB,KAAK,GAAAyB,KAAA,CAAAG,KAAA;UAAA;YACpB,IAAIxB,OAAO,CAACyB,MAAM,CAACC,OAAO,EAAE;cAC1B;YACF;YACA,IAAI,CAACnB,SAAS,IAAId,WAAW,KAAK,SAAS,EAAE;cAC3CO,OAAO,CAACE,MAAM,CAACyB,YAAY,CACzB3B,OAAO,CAACK,QAAQ,EACfuB,IAAI,IAAKlC,OAAO,CAACkC,IAAI,KAAK,KAAK,CAAC,GAAG/B,YAAY,GAAG+B,IAAI,EAAEhC,KAAK,CAChE,CAAC;YACH;YACAkB,MAAM,GAAGpB,OAAO,CAACoB,MAAM,EAAElB,KAAK,CAAC;UAAC;QAClC;MAAC,SAAAiC,GAAA;QAAAZ,iBAAA;QAAAC,cAAA,GAAAW,GAAA;MAAA;QAAA;UAAA,IAAAb,yBAAA,IAAAG,SAAA,CAAAW,MAAA;YAAA,MAAAX,SAAA,CAAAW,MAAA;UAAA;QAAA;UAAA,IAAAb,iBAAA;YAAA,MAAAC,cAAA;UAAA;QAAA;MAAA;MACD,IAAIX,SAAS,IAAId,WAAW,KAAK,SAAS,IAAI,CAACO,OAAO,CAACyB,MAAM,CAACC,OAAO,EAAE;QACrE1B,OAAO,CAACE,MAAM,CAACyB,YAAY,CAAC3B,OAAO,CAACK,QAAQ,EAAES,MAAM,CAAC;MACvD;MACA,OAAOd,OAAO,CAACE,MAAM,CAAC6B,YAAY,CAAC/B,OAAO,CAACK,QAAQ,CAAC;IACtD,CAAC;IAAA,iBAAA2B,EAAA;MAAA,OAAAlC,IAAA,CAAAmC,KAAA,OAAAC,SAAA;IAAA;EAAA;AACH;AACA,SACE3C,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}