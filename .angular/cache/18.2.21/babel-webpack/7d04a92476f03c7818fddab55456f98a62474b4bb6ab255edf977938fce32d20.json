{"ast":null,"code":"// src/retryer.ts\nimport { focusManager } from \"./focusManager.js\";\nimport { onlineManager } from \"./onlineManager.js\";\nimport { pendingThenable } from \"./thenable.js\";\nimport { isServer, sleep } from \"./utils.js\";\nfunction defaultRetryDelay(failureCount) {\n  return Math.min(1e3 * 2 ** failureCount, 3e4);\n}\nfunction canFetch(networkMode) {\n  return (networkMode ?? \"online\") === \"online\" ? onlineManager.isOnline() : true;\n}\nvar CancelledError = class extends Error {\n  constructor(options) {\n    super(\"CancelledError\");\n    this.revert = options?.revert;\n    this.silent = options?.silent;\n  }\n};\nfunction isCancelledError(value) {\n  return value instanceof CancelledError;\n}\nfunction createRetryer(config) {\n  let isRetryCancelled = false;\n  let failureCount = 0;\n  let continueFn;\n  const thenable = pendingThenable();\n  const isResolved = () => thenable.status !== \"pending\";\n  const cancel = cancelOptions => {\n    if (!isResolved()) {\n      const error = new CancelledError(cancelOptions);\n      reject(error);\n      config.onCancel?.(error);\n    }\n  };\n  const cancelRetry = () => {\n    isRetryCancelled = true;\n  };\n  const continueRetry = () => {\n    isRetryCancelled = false;\n  };\n  const canContinue = () => focusManager.isFocused() && (config.networkMode === \"always\" || onlineManager.isOnline()) && config.canRun();\n  const canStart = () => canFetch(config.networkMode) && config.canRun();\n  const resolve = value => {\n    if (!isResolved()) {\n      continueFn?.();\n      thenable.resolve(value);\n    }\n  };\n  const reject = value => {\n    if (!isResolved()) {\n      continueFn?.();\n      thenable.reject(value);\n    }\n  };\n  const pause = () => {\n    return new Promise(continueResolve => {\n      continueFn = value => {\n        if (isResolved() || canContinue()) {\n          continueResolve(value);\n        }\n      };\n      config.onPause?.();\n    }).then(() => {\n      continueFn = void 0;\n      if (!isResolved()) {\n        config.onContinue?.();\n      }\n    });\n  };\n  const run = () => {\n    if (isResolved()) {\n      return;\n    }\n    let promiseOrValue;\n    const initialPromise = failureCount === 0 ? config.initialPromise : void 0;\n    try {\n      promiseOrValue = initialPromise ?? config.fn();\n    } catch (error) {\n      promiseOrValue = Promise.reject(error);\n    }\n    Promise.resolve(promiseOrValue).then(resolve).catch(error => {\n      if (isResolved()) {\n        return;\n      }\n      const retry = config.retry ?? (isServer ? 0 : 3);\n      const retryDelay = config.retryDelay ?? defaultRetryDelay;\n      const delay = typeof retryDelay === \"function\" ? retryDelay(failureCount, error) : retryDelay;\n      const shouldRetry = retry === true || typeof retry === \"number\" && failureCount < retry || typeof retry === \"function\" && retry(failureCount, error);\n      if (isRetryCancelled || !shouldRetry) {\n        reject(error);\n        return;\n      }\n      failureCount++;\n      config.onFail?.(failureCount, error);\n      sleep(delay).then(() => {\n        return canContinue() ? void 0 : pause();\n      }).then(() => {\n        if (isRetryCancelled) {\n          reject(error);\n        } else {\n          run();\n        }\n      });\n    });\n  };\n  return {\n    promise: thenable,\n    status: () => thenable.status,\n    cancel,\n    continue: () => {\n      continueFn?.();\n      return thenable;\n    },\n    cancelRetry,\n    continueRetry,\n    canStart,\n    start: () => {\n      if (canStart()) {\n        run();\n      } else {\n        pause().then(run);\n      }\n      return thenable;\n    }\n  };\n}\nexport { CancelledError, canFetch, createRetryer, isCancelledError };","map":{"version":3,"names":["focusManager","onlineManager","pendingThenable","isServer","sleep","defaultRetryDelay","failureCount","Math","min","canFetch","networkMode","isOnline","CancelledError","Error","constructor","options","revert","silent","isCancelledError","value","createRetryer","config","isRetryCancelled","continueFn","thenable","isResolved","status","cancel","cancelOptions","error","reject","onCancel","cancelRetry","continueRetry","canContinue","isFocused","canRun","canStart","resolve","pause","Promise","continueResolve","onPause","then","onContinue","run","promiseOrValue","initialPromise","fn","catch","retry","retryDelay","delay","shouldRetry","onFail","promise","continue","start"],"sources":["E:/Projects/pokemon-angular-2025/node_modules/@tanstack/query-core/build/modern/retryer.js"],"sourcesContent":["// src/retryer.ts\nimport { focusManager } from \"./focusManager.js\";\nimport { onlineManager } from \"./onlineManager.js\";\nimport { pendingThenable } from \"./thenable.js\";\nimport { isServer, sleep } from \"./utils.js\";\nfunction defaultRetryDelay(failureCount) {\n  return Math.min(1e3 * 2 ** failureCount, 3e4);\n}\nfunction canFetch(networkMode) {\n  return (networkMode ?? \"online\") === \"online\" ? onlineManager.isOnline() : true;\n}\nvar CancelledError = class extends Error {\n  constructor(options) {\n    super(\"CancelledError\");\n    this.revert = options?.revert;\n    this.silent = options?.silent;\n  }\n};\nfunction isCancelledError(value) {\n  return value instanceof CancelledError;\n}\nfunction createRetryer(config) {\n  let isRetryCancelled = false;\n  let failureCount = 0;\n  let continueFn;\n  const thenable = pendingThenable();\n  const isResolved = () => thenable.status !== \"pending\";\n  const cancel = (cancelOptions) => {\n    if (!isResolved()) {\n      const error = new CancelledError(cancelOptions);\n      reject(error);\n      config.onCancel?.(error);\n    }\n  };\n  const cancelRetry = () => {\n    isRetryCancelled = true;\n  };\n  const continueRetry = () => {\n    isRetryCancelled = false;\n  };\n  const canContinue = () => focusManager.isFocused() && (config.networkMode === \"always\" || onlineManager.isOnline()) && config.canRun();\n  const canStart = () => canFetch(config.networkMode) && config.canRun();\n  const resolve = (value) => {\n    if (!isResolved()) {\n      continueFn?.();\n      thenable.resolve(value);\n    }\n  };\n  const reject = (value) => {\n    if (!isResolved()) {\n      continueFn?.();\n      thenable.reject(value);\n    }\n  };\n  const pause = () => {\n    return new Promise((continueResolve) => {\n      continueFn = (value) => {\n        if (isResolved() || canContinue()) {\n          continueResolve(value);\n        }\n      };\n      config.onPause?.();\n    }).then(() => {\n      continueFn = void 0;\n      if (!isResolved()) {\n        config.onContinue?.();\n      }\n    });\n  };\n  const run = () => {\n    if (isResolved()) {\n      return;\n    }\n    let promiseOrValue;\n    const initialPromise = failureCount === 0 ? config.initialPromise : void 0;\n    try {\n      promiseOrValue = initialPromise ?? config.fn();\n    } catch (error) {\n      promiseOrValue = Promise.reject(error);\n    }\n    Promise.resolve(promiseOrValue).then(resolve).catch((error) => {\n      if (isResolved()) {\n        return;\n      }\n      const retry = config.retry ?? (isServer ? 0 : 3);\n      const retryDelay = config.retryDelay ?? defaultRetryDelay;\n      const delay = typeof retryDelay === \"function\" ? retryDelay(failureCount, error) : retryDelay;\n      const shouldRetry = retry === true || typeof retry === \"number\" && failureCount < retry || typeof retry === \"function\" && retry(failureCount, error);\n      if (isRetryCancelled || !shouldRetry) {\n        reject(error);\n        return;\n      }\n      failureCount++;\n      config.onFail?.(failureCount, error);\n      sleep(delay).then(() => {\n        return canContinue() ? void 0 : pause();\n      }).then(() => {\n        if (isRetryCancelled) {\n          reject(error);\n        } else {\n          run();\n        }\n      });\n    });\n  };\n  return {\n    promise: thenable,\n    status: () => thenable.status,\n    cancel,\n    continue: () => {\n      continueFn?.();\n      return thenable;\n    },\n    cancelRetry,\n    continueRetry,\n    canStart,\n    start: () => {\n      if (canStart()) {\n        run();\n      } else {\n        pause().then(run);\n      }\n      return thenable;\n    }\n  };\n}\nexport {\n  CancelledError,\n  canFetch,\n  createRetryer,\n  isCancelledError\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}